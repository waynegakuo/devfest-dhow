<div class="helm-control-center">
  <!-- Page Header -->
  <div class="control-center-header">
    <div class="header-content">
      <h1 class="helm-title">
        <span class="title-icon">âš“</span>
        Admin Role Assignment
      </h1>
      <p class="helm-subtitle">Manage admin privileges for navigators in the DevFest fleet</p>
    </div>
  </div>

  <!-- Operation Status Messages -->
  @if (lastResult()) {
    <div class="operation-status" [class.success-message]="lastResult()?.success" [class.error-message]="!lastResult()?.success">
      <div class="status-content">
        <span class="status-icon">{{ lastResult()?.success ? 'âœ…' : 'âš ï¸' }}</span>
        <span class="status-message">{{ lastResult()?.message }}</span>
        <button class="btn-clear-status" (click)="clearResult()" aria-label="Clear status message">
          <span>âœ•</span>
        </button>
      </div>
    </div>
  }

  <div class="admin-controls-container">
    <!-- Assign Admin Role Section -->
    <div class="control-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="section-icon">ğŸ–ï¸</span>
          Promote Navigator to Admiral
        </h2>
        <p class="section-description">Grant admin privileges to a navigator by their email address</p>
      </div>

      <div class="form-container">
        <div class="input-group">
          <label for="assignEmail" class="form-label">Navigator Email Address</label>
          <div class="input-wrapper">
            <input
              id="assignEmail"
              type="email"
              class="form-input"
              placeholder="navigator@devfest.com"
              [value]="emailToAssign()"
              (input)="updateAssignEmail($event)"
              [disabled]="isAssigning()"
              autocomplete="assign-email"
            />
            <button
              class="btn-primary assign-btn"
              (click)="assignAdminRole()"
              [disabled]="isAssigning() || !emailToAssign().trim()"
              [attr.aria-label]="'Assign admin role to ' + emailToAssign()"
            >
              @if (isAssigning()) {
                <span class="loading-spinner">â³</span>
                <span>Promoting...</span>
              } @else {
                <span class="btn-icon">â¬†ï¸</span>
                <span>Promote to Admiral</span>
              }
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Remove Admin Role Section -->
    <div class="control-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="section-icon">â¬‡ï¸</span>
          Demote Admiral to Navigator
        </h2>
        <p class="section-description">Remove admin privileges from an admiral by their email address</p>
      </div>

      <div class="form-container">
        <div class="input-group">
          <label for="removeEmail" class="form-label">Admiral Email Address</label>
          <div class="input-wrapper">
            <input
              id="removeEmail"
              type="email"
              class="form-input"
              placeholder="admiral@devfest.com"
              [value]="emailToRemove()"
              (input)="updateRemoveEmail($event)"
              [disabled]="isAssigning()"
              autocomplete="remove-email"
            />
            <button
              class="btn-secondary remove-btn"
              (click)="removeAdminRole()"
              [disabled]="isAssigning() || !emailToRemove().trim()"
              [attr.aria-label]="'Remove admin role from ' + emailToRemove()"
            >
              @if (isAssigning()) {
                <span class="loading-spinner">â³</span>
                <span>Processing...</span>
              } @else {
                <span class="btn-icon">â¬‡ï¸</span>
                <span>Demote to Navigator</span>
              }
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Current Admirals Section -->
  <div class="admirals-section">
    <div class="section-header">
      <h2 class="section-title">
        <span class="section-icon">ğŸ‘‘</span>
        Current Fleet Admirals
      </h2>
      <div class="section-actions">
        <button
          class="btn-refresh"
          (click)="refreshAdminList()"
          [disabled]="loadingAdmins()"
          aria-label="Refresh admiral list"
        >
          @if (loadingAdmins()) {
            <span class="loading-spinner">â³</span>
          } @else {
            <span class="refresh-icon">ğŸ”„</span>
          }
          <span>Refresh</span>
        </button>
      </div>
    </div>

    <div class="admirals-list">
      @if (loadingAdmins()) {
        <div class="loading-state">
          <div class="loading-content">
            <span class="loading-spinner large">â³</span>
            <p>Loading fleet admirals...</p>
          </div>
        </div>
      } @else if (adminNavigators().length === 0) {
        <div class="empty-state">
          <div class="empty-content">
            <span class="empty-icon">ğŸ´â€â˜ ï¸</span>
            <h3>No Admirals Found</h3>
            <p>There are currently no navigators with admiral privileges in the fleet.</p>
          </div>
        </div>
      } @else {
        <div class="admirals-grid">
          @for (admiral of adminNavigators(); track admiral.id) {
            <div class="admiral-card">
              <div class="admiral-info">
                <div class="admiral-avatar">
                  @if (admiral.photoURL) {
                    <img
                      [src]="admiral.photoURL"
                      [alt]="admiral.displayName || 'Admiral'"
                      class="avatar-image"
                    />
                  } @else {
                    <div class="avatar-placeholder">
                      <span class="avatar-icon">ğŸ‘¤</span>
                    </div>
                  }
                </div>
                <div class="admiral-details">
                  <h4 class="admiral-name">{{ admiral.displayName || 'Anonymous Admiral' }}</h4>
                  <p class="admiral-email">{{ admiral.email }}</p>
                  <div class="admiral-badges">
                    <span class="badge admin-badge">Admiral</span>
                    @if (admiral.techTrack) {
                      <span class="badge track-badge">{{ admiral.techTrack }}</span>
                    }
                    @if (admiral.expertiseLevel) {
                      <span class="badge level-badge">{{ admiral.expertiseLevel }}</span>
                    }
                  </div>
                </div>
              </div>
              <div class="admiral-actions">
                @if (currentUser()?.email !== admiral.email) {
                  <button
                    class="btn-danger demote-btn"
                    (click)="removeAdminFromList(admiral.email || '')"
                    [disabled]="isAssigning()"
                    [attr.aria-label]="'Remove admin role from ' + (admiral.displayName || admiral.email)"
                  >
                    <span class="btn-icon">â¬‡ï¸</span>
                    <span>Demote</span>
                  </button>
                } @else {
                  <span class="current-user-label">You</span>
                }
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
